<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- Title -->
    <title>Yashraj Business Group - Blog Post</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    
    <!-- Font awesome CSS -->
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    
    <!-- Animate CSS -->
    <link rel="stylesheet" href="assets/css/animate.min.css">
    
    <!-- OwlCarousel CSS -->
    <link rel="stylesheet" href="assets/css/owl.carousel.css">
    
    <!-- Flaticon CSS -->
    <link rel="stylesheet" href="assets/flaticon/flaticon.css">
    
    <!-- SlickNav CSS -->
    <link rel="stylesheet" href="assets/css/slicknav.min.css">
    
    <!-- Featherlight  CSS -->
    <link rel="stylesheet" href="assets/css/featherlight.css">
    
    <!-- Featherlight Gallery CSS -->
    <link rel="stylesheet" href="assets/css/featherlight.gallery.css">
    
    <!-- Main CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
    
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="assets/css/responsive.css">

</head>
<body>
    
    <!-- Header Area Start -->
    <header class="bleezy-header-area">
        <div class="header-right-overlay"></div>
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <div class="site-logo">
                        <a href="index.html">
                            <img src="assets/YRBG-images/logo-yashraj-png.png" alt="site logo" />
                        </a>
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="header-right">
                        <div class="header-right-top">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="single-top-right">
                                        <p>Call Us: <a href="#">(+91) 80-907-85-907</a></p>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="single-top-right">
                                       
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                        <div class="menu-container">
                            <div class="row">
                                <div class="col-md-11 col-sm-11">
                                    <!-- Responsive Menu -->
                                    <div class="bleezy-responsive-menu"></div>
                                    <!-- Responsive Menu -->
                                    <div class="mainmenu">
                                        <nav>
                                            <ul id="bleezy_navigation">
                                                <li><a href="index.html">home</a></li>
                                                <li><a href="#">about us</a>
                                                    <ul>
                                                        <li><a href="company-profile.html">Company Profile</a></li>
                                                        <!-- <li><a href="security-guard.html">Managing Director</a></li>
                                                        <li><a href="security-guard.html">Licenses & Certificates</a> -->
                                                        </li>
                                                    </ul>
                                                </li>
                                                <li>
                                                    <a href="#">services</a>
                                                    <ul>
                                                        <li><a href="security-guard.html">security guard</a></li>
                                                        <li><a href="house-keeping.html">house keeping</a></li>
                                                        <li><a href="facility-management.html">facility management-Cleaning</a></li>
                                                        <li><a href="manpower-labour.html">manpower / labour supply</a></li>
                                                        <li><a href="contract-staffing.html">contract staffing / project planning</a></li>
                                                        <li><a href="pf-esic.html">pf esic & p.tax new reg.</a></li>
                                                        <li><a href="all-taxation.html">all taxation work</a></li>
                                                    </ul>
                                                </li>
                                                <li><a href="career.html">career</a></li>
                                                <li class="current-page-item"><a href="blog.html">blog</a></li>
                                                <li><a href="contact.html">contact</a></li>
                                            </ul>
                                        </nav>
                                    </div>
                                </div>
                                <div class="col-md-1 col-sm-1">
                                    <div class="header-search">
                                        <div class="search-icon">
                                            <i class="fa fa-search"></i>
                                        </div>
                                        <div class="search-form">
                                            <form>
                                                <input type="search" placeholder="Search..." >
                                                <button type="submit" ><i class="fa fa-search"></i></button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Header Area End -->
    
    <!-- Breadcromb Area Start -->
    <section class="bleezy-breadcromb-area">
        <div class="breadcromb-top section_50">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="breadcromb-top-text" style="float:right;">
                            <h2 id="blogTitle">Blog Post</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="breadcromb-bottom">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="breadcromb-bottom-text">
                            <ul>
                                <li><a href="index.html">home</a></li>
                                <li><a href="blog.html"><i class="fa fa-long-arrow-right"></i> blog</a></li>
                                <li><a href="#"><i class="fa fa-long-arrow-right"></i></a></li>
                                <li id="breadcrumbTitle">Blog Post</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcromb Area End -->
    
    <!-- Blog Details Area Start -->
    <section class="blog-details-area section_70">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <div class="blog-details" id="blogDetails">
                        <!-- Blog details will be loaded here -->
                        <div class="text-center">
                            <i class="fa fa-spinner fa-spin fa-3x"></i>
                            <p>Loading blog post...</p>
                        </div>
                    </div>
                    
                    <!-- Share Section -->
                    <div class="blog-share-tag">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="blog-share">
                                    <h4>Share This Post</h4>
                                    <ul>
                                        <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                                        <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                                        <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                                        <li><a href="#"><i class="fa fa-pinterest"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="blog-tag">
                                    <h4>Tags</h4>
                                    <ul>
                                        <li><a href="#">security</a></li>
                                        <li><a href="#">business</a></li>
                                        <li><a href="#">facility</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Related Posts -->
                    <div class="related-post-area">
                        <h3>Related Posts</h3>
                        <div class="row" id="relatedPostsContainer">
                            <!-- Related posts will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <!-- Sidebar -->
                <div class="col-md-4">
                    <div class="blog-sidebar">
                        <!-- Search Widget -->
                        <div class="single-sidebar">
                            <form>
                                <input type="search" placeholder="Search...">
                                <button type="submit"><i class="fa fa-search"></i></button>
                            </form>
                        </div>
                        
                        <!-- Recent Posts Widget -->
                        <div class="single-sidebar">
                            <h3>Recent Posts</h3>
                            <div class="recent-post" id="recentPostsContainer">
                                <!-- Recent posts will be loaded here -->
                            </div>
                        </div>
                        
                        <!-- Categories Widget -->
                        <div class="single-sidebar">
                            <h3>Categories</h3>
                            <ul>
                                <li><a href="#">Security Services</a></li>
                                <li><a href="#">Business Updates</a></li>
                                <li><a href="#">Industry News</a></li>
                                <li><a href="#">Facility Management</a></li>
                                <li><a href="#">Company Announcements</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Blog Details Area End -->
    
    <!-- Footer Area Start -->
    <footer class="bleezy-footer-area">
        <div class="footer-top-area section_50">
            <div class="container">
                <div class="row">
                    <div class="col-md-3 col-sm-3">
                        <div class="single-footer-widget footer-logo-widget">
                            <div class="footer-logo">
                                <a href="index.html">
                                    <img src="assets/YRBG-images/logo-yashraj-footer-png.png" alt="footer logo" />
                                </a>
                            </div>
                            <div class="footer-widget-text">
                                <p>YASHRAJ BUSINESS GROUP PVT.LTD. (Formerly Known as YASHRAJ SECURITY) is a start-up company founded by Mr.Vaibhav Amrut Patil....</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-3">
                        <div class="single-footer-widget">
                            <h3>main links</h3>
                            <ul>
                                <li><a href="about.html">About us</a></li>
                                <li><a href="career.html">Career</a></li>
                                <li><a href="blog.html">Blog</a></li>
                                <li><a href="contact.html">Contact</a></li>
                                <li><a href="#">Privacy Policy</a></li>
                                <li><a href="#">Terms & Conditions</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-3">
                        <div class="single-footer-widget">
                            <h3>Newsletter</h3>
                            <p>Don't miss to subscribe to our news feeds, kindly fill the form below.</p>
                            <form>
                                <input type="email" placeholder="Subscribe" >
                                <button type="submit" ><i class="fa fa-envelope-open-o"></i></button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="copyright-area">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="copyright-right">
                            <p>&copy; Copyright <a href="#">Yashraj Business Group</a> 2022. All rights reserved</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Area End -->
       <!-- jQuery -->
       <script src="assets/js/jquery.min.js"></script>
    
      <!-- Bootstrap JS -->
    <script src="assets/js/bootstrap.min.js"></script>
    
    <!-- Featherlight JS -->
    <script src="assets/js/featherlight.js"></script>
    
    <!-- Featherlight Gallery JS -->
    <script src="assets/js/featherlight.gallery.js"></script>
    
    <!-- OwlCarousel JS -->
    <script src="assets/js/owl.carousel.min.js"></script>
    
    <!-- SlickNav JS -->
    <script src="assets/js/jquery.slicknav.min.js"></script>
    
    <!-- Gmap JS -->
    <script src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyBf4UvvTN2QLWT4BiewE_3fEzK3QrRsLJE"></script>
    <script src="assets/js/gmap.js"></script>
    
    <!-- Progressbar js -->
    <script src="assets/js/progressbar.min.js"></script>
    
    <!-- Counter JS -->
    <script src="assets/js/jquery.counterup.min.js"></script>
    
    <!-- Counter JS -->
    <script src="assets/js/waypoints-min.js"></script>
    
    <!-- Custom JS -->
    <script src="assets/js/custom.js"></script>
    
    <!-- Blog Single Page JS -->
    <script>
        // Get blog ID from URL parameters
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Fetch and display a single blog post when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            const blogId = getUrlParameter('id');
            
            if (!blogId) {
                window.location.href = 'blog.html'; // Redirect to blog list if no ID is provided
                return;
            }
            
            fetchSingleBlog(blogId);
            fetchRecentBlogs();
        });

        // Function to fetch a single blog from the API
        function fetchSingleBlog(blogId) {
            fetch(`http://localhost:5000/api/blogs/${blogId}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(blog => {
                    displayBlogDetails(blog);
                    fetchRelatedPosts(blog._id);
                    
                    // Update page title
                    document.title = `${blog.title} - Yashraj Business Group`;
                    
                    // Update breadcrumb and page heading
                    document.getElementById('blogTitle').textContent = blog.title;
                    document.getElementById('breadcrumbTitle').textContent = blog.title;
                })
                .catch(error => {
                    console.error('Error fetching blog:', error);
                    document.getElementById('blogDetails').innerHTML = `
                        <div class="alert alert-warning">
                            Failed to load blog post. Please try again later or <a href="blog.html">return to blog list</a>.
                        </div>
                    `;
                });
        }

        // Function to display blog details
        function displayBlogDetails(blog) {
            const blogDetailsContainer = document.getElementById('blogDetails');
            const date = new Date(blog.createdAt);
            const formattedDate = date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            // Create blog content with proper formatting
            // We're assuming the content might contain HTML formatting
            const blogHtml = `
                <div class="blog-image">
                    <img src="${blog.image}" alt="${blog.title}">
                    <div class="post-date">
                        <p>${date.getDate()}<span>${date.toLocaleDateString('en-US', {month: 'short'})}</span></p>
                    </div>
                </div>
                <div class="blog-meta">
                    <ul>
                        <li><i class="fa fa-user"></i> <a href="#">${blog.author.username}</a></li>
                        <li><i class="fa fa-calendar"></i> <a href="#">${formattedDate}</a></li>
                    </ul>
                </div>
                <h2>${blog.title}</h2>
                <div class="blog-content">
                    ${formatContent(blog.content)}
                </div>
            `;
            
            blogDetailsContainer.innerHTML = blogHtml;
        }

        // Function to format blog content, splitting paragraphs
        function formatContent(content) {
            // If content already has HTML formatting, return as is
            if (content.includes('<p>') || content.includes('<div>')) {
                return content;
            }
            
            // Otherwise, split by new lines and wrap in paragraph tags
            return content.split('\n\n')
                .filter(para => para.trim() !== '')
                .map(para => `<p>${para}</p>`)
                .join('');
        }

        // Function to fetch related posts
        function fetchRelatedPosts(currentBlogId) {
            fetch('/api/blogs')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(blogs => {
                    // Filter out current blog and get max 3 related posts
                    const relatedBlogs = blogs
                        .filter(blog => blog._id !== currentBlogId)
                        .slice(0, 3);
                    
                    displayRelatedPosts(relatedBlogs);
                })
                .catch(error => {
                    console.error('Error fetching related blogs:', error);
                    document.getElementById('relatedPostsContainer').innerHTML = 'Unable to load related posts.';
                });
        }

        // Function to display related posts
        function displayRelatedPosts(blogs) {
            const relatedPostsContainer = document.getElementById('relatedPostsContainer');
            relatedPostsContainer.innerHTML = '';

            if (blogs.length === 0) {
                relatedPostsContainer.innerHTML = '<p>No related posts found.</p>';
                return;
            }

            blogs.forEach(blog => {
                const date = new Date(blog.createdAt);
                
                const relatedPostHtml = `
                    <div class="col-md-4">
                        <div class="single-related-post">
                            <div class="related-post-img">
                                <a href="blog-single.html?id=${blog._id}">
                                    <img src="${blog.image}" alt="${blog.title}">
                                </a>
                            </div>
                            <div class="related-post-text">
                                <h4><a href="blog-single.html?id=${blog._id}">${blog.title}</a></h4>
                                <p>${date.toLocaleDateString('en-US', {year: 'numeric', month: 'short', day: 'numeric'})}</p>
                            </div>
                        </div>
                    </div>
                `;
                
                relatedPostsContainer.innerHTML += relatedPostHtml;
            });
        }

        // Function to fetch recent blogs for sidebar
        function fetchRecentBlogs() {
            fetch('http://localhost:5000/api/blogs')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(blogs => {
                    // Get 5 most recent posts for sidebar
                    displayRecentPosts(blogs.slice(0, 5));
                })
                .catch(error => {
                    console.error('Error fetching recent blogs:', error);
                    document.getElementById('recentPostsContainer').innerHTML = 'Unable to load recent posts.';
                });
        }

        // Function to display recent posts in the sidebar
        function displayRecentPosts(blogs) {
            const recentPostsContainer = document.getElementById('recentPostsContainer');
            recentPostsContainer.innerHTML = '';

            blogs.forEach(blog => {
                const date = new Date(blog.createdAt);
                const formattedDate = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });

                const recentPostHtml = `
                    <div class="single-recent-post">
                        <div class="recent-post-img">
                            <a href="blog-single.html?id=${blog._id}">
                                <img src="${blog.image}" alt="${blog.title}">
                            </a>
                        </div>
                        <div class="recent-post-text">
                            <h4><a href="blog-single.html?id=${blog._id}">${blog.title}</a></h4>
                            <p>${formattedDate}</p>
                        </div>
                    </div>
                `;
                
                recentPostsContainer.innerHTML += recentPostHtml;
            });
        }
    </script>
</body>
</html>